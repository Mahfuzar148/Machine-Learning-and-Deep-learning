
---

## ЁЯФН ржХрзЛржб:

```python
transform = transforms.Compose([
    transforms.ToTensor(),
    transforms.Normalize((0.1307,), (0.3081,))
])
```

---

## ЁЯУД ржПржЯрж┐ ржХрзЗржи ржжрж░ржХрж╛рж░?

ржЖржорж░рж╛ ржпржЦржи PyTorch ржжрж┐рзЯрзЗ ржЫржмрж┐ ржнрж┐рждрзНрждрж┐ржХ ржбрж┐ржк рж▓рж╛рж░рзНржирж┐ржВ ржоржбрзЗрж▓ ржмрж╛ржирж╛ржЗ (ржпрзЗржоржиржГ CNN), рждржЦржи ржЫржмрж┐ржЧрзБрж▓рзЛржХрзЗ ржкрзНрж░рж┐-ржкрзНрж░рж╕рзЗрж╕ ржХрж░рждрзЗ рж╣рзЯ, ржпрж╛рждрзЗ:

* ржЫржмрж┐ ржЯрзЗржирж╕рж░рзЗ ржХржиржнрж╛рж░рзНржЯ рж╣рзЯ (PyTorch ржЯрзЗржирж╕рж░ рж╕рж╛ржкрзЛрж░рзНржЯ ржХрж░рзЗ)
* ржкрж┐ржХрзНрж╕рзЗрж▓ ржорж╛ржиржЧрзБрж▓рзЛ 0-1 рж╕рзНржХрзЗрж▓рзЗ ржЖрж╕рзЗ (scaling)
* рждрж╛рж░ржкрж░ ржбрзЗржЯрж╛ center рж╣рзЯ (mean=0 ржПрж░ ржжрж┐ржХрзЗ ржЖржирж╛ рж╣рзЯ)
* ржоржбрзЗрж▓ ржнрж╛рж▓рзЛржнрж╛ржмрзЗ ржПржмржВ ржжрзНрж░рзБржд рж╢рж┐ржЦрждрзЗ ржкрж╛рж░рзЗ

ржПржЗ рж╕ржм ржХрж╛ржЬ ржПржХрж╕рж╛ржерзЗ ржХрж░рждрзЗ ржЖржорж░рж╛ `transforms.Compose([...])` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж┐ред

---

## ЁЯз▒ рж▓рж╛ржЗржи ржмрж╛ржЗ рж▓рж╛ржЗржи ржбржХрзБржорзЗржирзНржЯрзЗрж╢ржи

---

### тЬЕ 1. `transforms.Compose([...])`

ЁЯСЙ ржПржЯрж┐ рж╣рж▓рзЛ ржПржХржЯрж┐ ржХржорзНржкрзЛржЬрж┐рж╢ржи ржХрзНрж▓рж╛рж╕, ржпрзЗржЦрж╛ржирзЗ рждрзБржорж┐ ржПржХрж╛ржзрж┐ржХ image transformation ржмрж╛ processing рж╕рзНржЯрзЗржк ржПржХрждрзНрж░рзЗ ржжрж┐рзЯрзЗ рж░рж╛ржЦрждрзЗ ржкрж╛рж░рзЛред
ржПржЦрж╛ржирзЗ ржПржХрж╛ржзрж┐ржХ transforms ржХрзЗ ржЪрзЗржЗржи ржХрж░рзЗ ржПржХржЯрж╛ржЗ `transform` ржЕржмржЬрзЗржХрзНржЯ ржмрж╛ржирж╛ржирзЛ рж╣рзЯред

ЁЯУМ ржЙржжрж╛рж╣рж░ржг:
ржЗржорзЗржЬ ржЯрзЗржирж╕рж░рзЗ рж░рзВржкрж╛ржирзНрждрж░ тЖТ рждрж╛рж░ржкрж░ ржирж░ржорж╛рж▓рж╛ржЗржЬ тЖТ рждрж╛рж░ржкрж░ рж░рж┐рж╕рж╛ржЗржЬ тЖТ рж╕ржм ржПржХрждрзНрж░рзЗ `Compose` ржП рж░рж╛ржЦрж╛ ржпрж╛рзЯред

---

### тЬЕ 2. `transforms.ToTensor()`

#### ЁЯФз ржХрж╛ржЬ:

* ржЗржорзЗржЬ ржлрж╛ржЗрж▓ (PIL Image or NumPy array) ржХрзЗ **PyTorch Tensor** рждрзЗ ржХржиржнрж╛рж░рзНржЯ ржХрж░рзЗ
* ржкрж┐ржХрзНрж╕рзЗрж▓ ржорж╛ржиржЧрзБрж▓рзЛрж░ рж╕рзНржХрзЗрж▓ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рзЗ:
  `0тАУ255 тЖТ 0.0тАУ1.0`

#### ЁЯФБ ржорж╛ржирзЗ:

* ржЗржорзЗржЬрзЗрж░ ржбрзЗржЯрж╛ float32 ржЯрж╛ржЗржкрзЗ ржПржмржВ PyTorch format (`[C, H, W]`) ржП рж░рзВржкрж╛ржирзНрждрж░рж┐ржд рж╣рзЯред

#### ЁЯФе ржирж╛ ржХрж░рж▓рзЗ ржХрзА рж╣ржмрзЗ?

* ржоржбрзЗрж▓ PyTorch ржЯрзЗржирж╕рж░ ржЗржиржкрзБржЯ рж╣рж┐рж╕рзЗржмрзЗ ржирзЗржмрзЗ ржирж╛
* Training ржХрж╛ржЬржЗ ржХрж░ржмрзЗ ржирж╛
* ржЗржорзЗржЬ float32 ржирж╛ рж╣рж▓рзЗ ржЧрзНрж░рзНржпрж╛ржбрж┐рзЯрзЗржирзНржЯ ржХрзНржпрж╛рж▓ржХрзБрж▓рзЗрж╢ржи рж╣ржмрзЗ ржирж╛

---

### тЬЕ 3. `transforms.Normalize((0.1307,), (0.3081,))`

#### ЁЯФз ржХрж╛ржЬ:

ржЗржорзЗржЬ ржЯрзЗржирж╕рж░рзЗрж░ ржкрзНрж░рждрж┐ржЯрж┐ ржкрж┐ржХрзНрж╕рзЗрж▓ржХрзЗ **normalize** ржХрж░рзЗ ржирж┐ржЪрзЗрж░ ржлрж░рзНржорзБрж▓рж╛ ржЕржирзБрж╕рж╛рж░рзЗ:

$$
\text{output} = \frac{\text{input} - \text{mean}}{\text{std}}
$$

#### ржПржЦрж╛ржирзЗ:

* `mean = 0.1307`
* `std = 0.3081`

ЁЯУМ ржПржЯрж╛ MNIST ржбрзЗржЯрж╛рж╕рзЗржЯрзЗрж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд ржорзЗржЯрзНрж░рж┐ржХрж╕ред MNIST ржбрзЗржЯрж╛рж╕рзЗржЯрзЗрж░ рж╕ржорж╕рзНржд ржкрж┐ржХрзНрж╕рзЗрж▓ ржнрзНржпрж╛рж▓рзБрж░ ржЧрзЬ рж╣рж▓ `0.1307` ржПржмржВ рж╕рзНржЯрзНржпрж╛ржирзНржбрж╛рж░рзНржб ржбрзЗржнрж┐рзЯрзЗрж╢ржи `0.3081`

#### ЁЯФБ ржорж╛ржирзЗ:

* рж╕ржм ржбрзЗржЯрж╛ржХрзЗ ржПржХржЗ рж╕рзНржХрзЗрж▓рзЗ ржирж┐рзЯрзЗ ржЖрж╕рж╛ рж╣рзЯ (standardization)
* gradient descent ржжрзНрж░рзБржд ржУ рж╕ржарж┐ржХржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ

#### ЁЯФе ржирж╛ ржХрж░рж▓рзЗ ржХрзА рж╣ржмрзЗ?

* ржоржбрзЗрж▓рзЗрж░ ржЯрзНрж░рзЗржЗржирж┐ржВ ржзрзАрж░рзЗ ржЪрж▓ржмрзЗ
* ржУржЬржи ржЖржкржбрзЗржЯ ржарж┐ржХржнрж╛ржмрзЗ рж╣ржмрзЗ ржирж╛
* overfitting ржмрж╛ underfitting рж╣рждрзЗ ржкрж╛рж░рзЗ
* ржнрж┐ржирзНржи ржнрж┐ржирзНржи рж╕рзНржХрзЗрж▓рзЗрж░ ржбрзЗржЯрж╛ ржирж┐рзЯрзЗ ржоржбрзЗрж▓ ржмрж┐ржнрзНрж░рж╛ржирзНржд рж╣рждрзЗ ржкрж╛рж░рзЗ

---

## ЁЯзк ржкрзНрж░рзНржпрж╛ржХржЯрж┐ржХрж╛рж▓ ржжрзГрж╖рзНржЯрж┐ржХрзЛржг ржерзЗржХрзЗ:

| ржХрж╛ржЬ                            | ToTensor() ржирж╛ ржжрж┐рж▓рзЗ            | Normalize() ржирж╛ ржжрж┐рж▓рзЗ            |
| ------------------------------ | ----------------------------- | ------------------------------ |
| Image to tensor                | тЭМ ржоржбрзЗрж▓ ржПржХрзНрж╕рзЗржкрзНржЯ ржХрж░ржмрзЗ ржирж╛       | тЬФя╕П ржЪрж▓ржмрзЗ, рждржмрзЗ ржмрж╛ржЬрзЗ ржкрж╛рж░ржлрж░ржорзНржпрж╛ржирзНрж╕ |
| Scaling (0тАУ1)                  | тЭМ gradient ржарж┐ржХржорждрзЛ ржХрж╛ржЬ ржХрж░ржмрзЗ ржирж╛ | тЬФя╕П ржЪрж▓ржмрзЗ, ржХрж┐ржирзНрждрзБ ржзрзАрж░            |
| Training stability             | тЭМ                             | тЭМ                              |
| Accuracy                       | тЭМ                             | тЭМ                              |
| Dataset-specific preprocessing | тЭМ                             | тЭМ                              |

---

## тЬЕ ржХржЦржи ржПржЗ Transform ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржм?

* ржпржЦржи рждрзБржорж┐ PyTorch ржжрж┐рзЯрзЗ ржЗржорзЗржЬ ржоржбрзЗрж▓ ржмрж╛ржирж╛ржмрзЗ
* ржмрж┐рж╢рзЗрж╖ ржХрж░рзЗ grayscale ржЗржорзЗржЬ ржирж┐рзЯрзЗ (ржпрзЗржоржиржГ MNIST)
* ржпржЦржи ржоржбрзЗрж▓ ржнрж╛рж▓ ржПржмржВ ржжрзНрж░рзБржд ржЯрзНрж░рзЗржЗржи ржХрж░рждрзЗ ржЪрж╛ржУ

---

## тЬЕ ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ?

ржПржЗ ржХрзЛржбржЯрж╛ ржпржЦржи `datasets.MNIST()` ржмрж╛ `DataLoader()` ржП `transform=transform` ржжрж┐рзЯрзЗ ржкрж╛рж╕ ржХрж░рж╛ рж╣рзЯ, рждржЦржи ржкрзНрж░рждрж┐ржЯрж┐ ржЗржорзЗржЬрзЗрж░ ржУржкрж░ ржПржЗ ржжрзБржЗржЯрж┐ ржЕржкрж╛рж░рзЗрж╢ржи ржЪрж╛рж▓рж╛ржирзЛ рж╣рзЯ:

```python
image = ToTensor(image)
image = Normalize(image)
```

---

## тЬЕ ржкрзБрж░рзЛ ржбржХрзБржорзЗржирзНржЯрзЗрж╢ржирзЗрж░ рж╕рж╛рж░рж╛ржВрж╢:

```python
# Full Explanation
transform = transforms.Compose([
    transforms.ToTensor(),                     # Step 1: Convert image to PyTorch Tensor and scale to [0,1]
    transforms.Normalize((0.1307,), (0.3081,)) # Step 2: Normalize tensor using MNIST's mean and std
])
```

---

## ЁЯФЪ рж╢рзЗрж╖ ржХржерж╛:

* тЬЕ `ToTensor()` ржУ `Normalize()` тАФ ржПржЗ ржжрзБржЯрзЛ ржорж┐рж▓рзЗ PyTorch ржоржбрзЗрж▓рзЗрж░ ржЬржирзНржп ржбрзЗржЯрж╛ ржкрж╛рж░ржлрзЗржХрзНржЯрж▓рж┐ ржкрзНрж░рж╕рзНрждрзБржд ржХрж░рзЗред
* тЭМ ржпрзЗржХрзЛржирзЛ ржПржХржЯрж╛ ржмрж╛ржж ржжрж┐рж▓рзЗржУ ржоржбрзЗрж▓ ржарж┐ржХржорждрзЛ рж╢рж┐ржЦржмрзЗ ржирж╛, ржкрж╛рж░ржлрж░ржорзНржпрж╛ржирзНрж╕ ржЦрж╛рж░рж╛ржк рж╣ржмрзЗред
* ЁЯОп ржПржЯрж╛ рж╢рзБржзрзБ MNIST ржирзЯ, CIFAR, ImageNet тАФ рж╕ржм ржбрзЗржЯрж╛рж╕рзЗржЯрзЗржЗ ржЖрж▓рж╛ржжрж╛ mean/std ржжрж┐рзЯрзЗ normalization ржХрж░рж╛ рж╣рзЯред

---

