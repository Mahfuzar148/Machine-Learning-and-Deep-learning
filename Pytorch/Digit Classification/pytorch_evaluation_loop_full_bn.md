
---

## **Evaluation Loop ‚Äî ‡¶≤‡¶æ‡¶á‡¶®‡ßá ‡¶≤‡¶æ‡¶á‡¶®‡ßá ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ñ‡ßç‡¶Ø‡¶æ**

‡¶ß‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶ï ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶°‡ßá‡¶∂‡¶® ‡¶¨‡¶æ ‡¶ü‡ßá‡¶∏‡ßç‡¶ü ‡¶≤‡ßÅ‡¶™ ‡¶è‡¶á ‡¶∞‡¶ï‡¶Æ:

```python
def evaluate(model, device, data_loader, criterion):
    model.eval()  # 1
    total_loss = 0.0  # 2
    correct = 0        # 3
    total = 0          # 4

    with torch.no_grad():  # 5
        for data, targets in data_loader:  # 6
            data, targets = data.to(device), targets.to(device)  # 7
            outputs = model(data)  # 8
            loss = criterion(outputs, targets)  # 9
            total_loss += loss.item()  # 10

            preds = outputs.argmax(dim=1)  # 11
            correct += (preds == targets).sum().item()  # 12
            total += targets.size(0)  # 13

    avg_loss = total_loss / len(data_loader)  # 14
    accuracy = correct / total  # 15
    return avg_loss, accuracy  # 16
```

---

### **1. `model.eval()`**

* ‡¶Æ‡¶°‡ßá‡¶≤‡¶ï‡ßá **evaluation mode**-‡¶è ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßá‡•§
* Dropout, BatchNorm-‡¶è‡¶∞ ‡¶Æ‡¶§‡ßã ‡¶≤‡ßá‡ßü‡¶æ‡¶∞‡¶ó‡ßÅ‡¶≤‡ßã ‡¶è‡¶ñ‡¶® deterministic ‡¶Ü‡¶ö‡¶∞‡¶£ ‡¶ï‡¶∞‡¶¨‡ßá‡•§
* ‡¶Ø‡¶¶‡¶ø ‡¶è‡¶ü‡¶æ ‡¶®‡¶æ ‡¶¶‡¶æ‡¶ì, ‡¶§‡¶æ‡¶π‡¶≤‡ßá evaluation-‡¶è‡¶∞ ‡¶∏‡¶Æ‡ßü ‡¶∞‚Äç‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶Æ Dropout/BatchNorm ‡¶Ü‡¶™‡¶°‡ßá‡¶ü‡ßá‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£‡ßá ‡¶≠‡ßÅ‡¶≤ ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü ‡¶Ü‡¶∏‡¶¨‡ßá‡•§
* **‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ**: ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡¶ø‡¶Ç ‡¶∂‡ßá‡¶∑‡ßá ‡¶¨‡¶æ ‡¶ü‡ßá‡¶∏‡ßç‡¶ü‡ßá‡¶∞ ‡¶Ü‡¶ó‡ßá ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶è‡¶á ‡¶≤‡¶æ‡¶á‡¶®‡¶ü‡¶æ ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§

---

### **2. `total_loss = 0.0`**

* ‡¶∏‡¶Æ‡¶∏‡ßç‡¶§ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö‡ßá‡¶∞ ‡¶≤‡¶∏ ‡¶ú‡¶Æ‡¶æ ‡¶∞‡¶æ‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡•§
* ‡¶∂‡ßá‡¶∑‡ßá ‡¶ó‡ßú ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá (`avg_loss`)‡•§
* ‡¶Ø‡¶¶‡¶ø ‡¶è‡¶ü‡¶æ ‡¶≠‡ßÅ‡¶≤‡ßá ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡ßü‡¶æ‡¶≤‡¶æ‡¶á‡¶ú ‡¶®‡¶æ ‡¶ï‡¶∞‡ßã, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡ßÅ ‡¶ú‡¶Æ‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá‡•§

---

### **3. `correct = 0`**

* ‡¶Æ‡ßã‡¶ü ‡¶∏‡¶†‡¶ø‡¶ï ‡¶™‡ßç‡¶∞‡ßá‡¶°‡¶ø‡¶ï‡¶∂‡¶®‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶∞‡¶æ‡¶ñ‡¶¨‡ßá‡•§

---

### **4. `total = 0`**

* ‡¶Æ‡ßã‡¶ü ‡¶™‡ßç‡¶∞‡ßá‡¶°‡¶ø‡¶ï‡¶∂‡¶® ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡•§
* accuracy ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞‡•§

---

### **5. `with torch.no_grad():`**

* PyTorch-‡¶ï‡ßá ‡¶¨‡¶≤‡ßá ‡¶¶‡ßá‡ßü **‡¶ó‡ßç‡¶∞‡ßá‡¶°‡¶ø‡ßü‡ßá‡¶®‡ßç‡¶ü ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡¶ï‡ßÅ‡¶≤‡ßá‡¶∂‡¶® ‡¶¨‡¶®‡ßç‡¶ß ‡¶∞‡¶æ‡¶ñ‡¶§‡ßá**‡•§
* ‡¶Æ‡ßá‡¶Æ‡¶∞‡¶ø ‡¶ì ‡¶ï‡¶Æ‡ßç‡¶™‡¶ø‡¶â‡¶ü ‡¶∏‡¶Æ‡ßü ‡¶¨‡¶æ‡¶Å‡¶ö‡ßá, ‡¶ï‡¶æ‡¶∞‡¶£ evaluation-‡¶è ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶™‡ßç‡¶∞‡¶™ ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞ ‡¶π‡ßü ‡¶®‡¶æ‡•§
* ‡¶®‡¶æ ‡¶¶‡¶ø‡¶≤‡ßá ‡¶Ö‡¶Ø‡¶•‡¶æ ‡¶ó‡ßç‡¶∞‡ßá‡¶°‡¶ø‡ßü‡ßá‡¶®‡ßç‡¶ü ‡¶ú‡¶Æ‡¶æ ‡¶π‡¶¨‡ßá‡•§

---

### **6. `for data, targets in data_loader:`**

* DataLoader ‡¶•‡ßá‡¶ï‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö ‡¶Ü‡¶®‡¶æ‡•§
* ‡¶è‡¶ñ‡¶æ‡¶®‡ßá:

  * **`data`** ‚Üí ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶á‡¶Æ‡ßá‡¶ú/‡¶´‡¶ø‡¶ö‡¶æ‡¶∞‡¶∏
  * **`targets`** ‚Üí ‡¶∏‡¶§‡ßç‡¶Ø‡¶ø‡¶ï‡¶æ‡¶∞‡ßá‡¶∞ ‡¶≤‡ßá‡¶¨‡ßá‡¶≤
* `batch_size` ‡¶¨‡ßú ‡¶π‡¶≤‡ßá ‡¶≤‡ßÅ‡¶™‡ßá‡¶∞ ‡¶á‡¶ü‡¶æ‡¶∞‡ßá‡¶∂‡¶® ‡¶ï‡¶Æ ‡¶π‡ßü, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶Æ‡ßá‡¶Æ‡¶∞‡¶ø ‡¶¨‡ßá‡¶∂‡¶ø ‡¶≤‡¶æ‡¶ó‡ßá‡•§

---

### **7. `data, targets = data.to(device), targets.to(device)`**

* ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶Ü‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶è‡¶ï‡¶á ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏‡ßá (CPU/GPU) ‡¶Ü‡¶®‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§
* ‡¶Ø‡¶¶‡¶ø ‡¶Æ‡¶°‡ßá‡¶≤ GPU-‡¶§‡ßá ‡¶π‡ßü ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶°‡ßá‡¶ü‡¶æ CPU-‡¶§‡ßá ‡¶•‡¶æ‡¶ï‡ßá, ‡¶§‡¶æ‡¶π‡¶≤‡ßá `RuntimeError` ‡¶π‡¶¨‡ßá‡•§

---

### **8. `outputs = model(data)`**

* ‡¶´‡¶∞‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶™‡¶æ‡¶∏ ‡¶ï‡¶∞‡ßá ‡¶™‡ßç‡¶∞‡ßá‡¶°‡¶ø‡¶ï‡¶∂‡¶® ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡¶æ‡•§
* Classification ‡¶π‡¶≤‡ßá shape ‡¶π‡¶¨‡ßá `[batch_size, num_classes]`‡•§

---

### **9. `loss = criterion(outputs, targets)`**

* ‡¶≤‡¶∏ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® (‡¶Ø‡ßá‡¶Æ‡¶® CrossEntropyLoss) ‡¶¶‡¶ø‡ßü‡ßá ‡¶≤‡¶∏ ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡¶æ‡•§
* ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶°‡ßá‡¶∂‡¶® ‡¶≤‡¶∏ ‡¶Æ‡¶°‡ßá‡¶≤‡ßá‡¶∞ ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡¶æ‡¶≤‡¶æ‡¶á‡¶ú‡ßá‡¶∂‡¶® ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø ‡¶ï‡¶∞‡ßá‡•§

---

### **10. `total_loss += loss.item()`**

* `.item()` ‚Üí ‡¶ü‡ßá‡¶®‡¶∏‡¶∞ ‡¶•‡ßá‡¶ï‡ßá scalar float ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶®‡ßá‡ßü‡•§
* ‡¶∏‡¶¨ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö‡ßá‡¶∞ ‡¶≤‡¶∏ ‡¶Ø‡ßã‡¶ó ‡¶π‡ßü, ‡¶™‡¶∞‡ßá ‡¶ó‡ßú ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡¶¨‡•§

---

### **11. `preds = outputs.argmax(dim=1)`**

* **`argmax`** ‚Üí ‡¶∏‡¶¨‡¶ö‡ßá‡ßü‡ßá ‡¶¨‡ßú ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡ßÅ‡¶∞ ‡¶á‡¶®‡¶°‡ßá‡¶ï‡ßç‡¶∏ ‡¶®‡ßá‡ßü, ‡¶Ø‡ßá‡¶ü‡¶ø predicted class‡•§
* `dim=1` ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø row (sample)-‡¶§‡ßá classes ‡¶•‡¶æ‡¶ï‡ßá‡•§

---

### **12. `correct += (preds == targets).sum().item()`**

* ‡¶™‡ßç‡¶∞‡ßá‡¶°‡¶ø‡¶ï‡¶∂‡¶® ‡¶Ü‡¶∞ ‡¶Ü‡¶∏‡¶≤ ‡¶≤‡ßá‡¶¨‡ßá‡¶≤ ‡¶Æ‡¶ø‡¶≤‡ßá ‡¶ó‡ßá‡¶≤‡ßá `True` (1), ‡¶®‡¶æ ‡¶Æ‡¶ø‡¶≤‡¶≤‡ßá `False` (0)‡•§
* `.sum()` ‡¶¶‡¶ø‡ßü‡ßá ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö‡ßá ‡¶ï‡ßü‡¶ü‡¶æ ‡¶∏‡¶†‡¶ø‡¶ï ‡¶π‡ßü‡ßá‡¶õ‡ßá ‡¶§‡¶æ ‡¶¨‡ßá‡¶∞ ‡¶π‡ßü, `.item()` ‡¶¶‡¶ø‡ßü‡ßá float/‡¶á‡¶®‡ßç‡¶ü‡ßá ‡¶ï‡¶®‡¶≠‡¶æ‡¶∞‡ßç‡¶ü‡•§

---

### **13. `total += targets.size(0)`**

* ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö‡ßá ‡¶ï‡ßü‡¶ü‡¶æ ‡¶∏‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶™‡¶≤ ‡¶Ü‡¶õ‡ßá ‡¶∏‡ßá‡¶ü‡¶æ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ‡•§
* Accuracy ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡¶§‡ßá ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞‡•§

---

### **14. `avg_loss = total_loss / len(data_loader)`**

* ‡¶Æ‡ßã‡¶ü ‡¶≤‡¶∏‡¶ï‡ßá ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶¶‡¶ø‡ßü‡ßá ‡¶≠‡¶æ‡¶ó ‡¶ï‡¶∞‡ßá ‡¶ó‡ßú ‡¶≤‡¶∏ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡•§

---

### **15. `accuracy = correct / total`**

* ‡¶Æ‡ßã‡¶ü ‡¶∏‡¶†‡¶ø‡¶ï ‡¶™‡ßç‡¶∞‡ßá‡¶°‡¶ø‡¶ï‡¶∂‡¶®‡ßá‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶™‡¶æ‡¶§‡•§

---

### **16. `return avg_loss, accuracy`**

* ‡¶ó‡ßú ‡¶≤‡¶∏ ‡¶Ü‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßÅ‡¶∞‡ßá‡¶∏‡¶ø ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶´‡ßá‡¶∞‡¶§ ‡¶¶‡ßá‡ßü‡•§
* ‡¶è‡¶ó‡ßÅ‡¶≤‡ßã ‡¶≤‡ßÅ‡¶™ ‡¶∂‡ßá‡¶∑‡ßá ‡¶≤‡¶ó ‡¶¨‡¶æ ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡ßá ‡¶Æ‡¶°‡ßá‡¶≤‡ßá‡¶∞ ‡¶™‡¶æ‡¶∞‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏ ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶π‡ßü‡•§

---

## **üìå ‡¶™‡ßç‡¶Ø‡¶æ‡¶∞‡¶æ‡¶Æ‡¶ø‡¶ü‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®‡ßá ‡¶™‡ßç‡¶∞‡¶≠‡¶æ‡¶¨**

* **`batch_size`** ‚Üí ‡¶¨‡ßú ‡¶π‡¶≤‡ßá ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶Æ‡ßá‡¶Æ‡¶∞‡¶ø ‡¶¨‡ßá‡¶∂‡¶ø; ‡¶õ‡ßã‡¶ü ‡¶π‡¶≤‡ßá ‡¶∏‡ßç‡¶≤‡ßã ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶ï‡¶Æ ‡¶Æ‡ßá‡¶Æ‡¶∞‡¶ø‡•§
* **`criterion`** ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡¶≤‡ßá ‡¶≤‡¶∏ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡¶ï‡ßÅ‡¶≤‡ßá‡¶∂‡¶® ‡¶™‡¶¶‡ßç‡¶ß‡¶§‡¶ø ‡¶¨‡¶¶‡¶≤‡¶æ‡ßü (‡¶Ø‡ßá‡¶Æ‡¶® MSE vs CrossEntropy)‡•§
* **`argmax(dim=1)`** ‚Üí dim ‡¶≠‡ßÅ‡¶≤ ‡¶¶‡¶ø‡¶≤‡ßá ‡¶≠‡ßÅ‡¶≤ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßÅ‡¶∞‡ßá‡¶∏‡¶ø ‡¶Ü‡¶∏‡¶¨‡ßá‡•§
* **`no_grad()`** ‡¶¨‡¶æ‡¶¶ ‡¶¶‡¶ø‡¶≤‡ßá ‡¶Æ‡ßá‡¶Æ‡¶∞‡¶ø ‡¶≤‡¶ø‡¶ï/‡¶∏‡ßç‡¶≤‡ßã ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡¶ø‡¶Ç‡•§

---

